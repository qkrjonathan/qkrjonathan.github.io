<html>
    <head>
        <title>Live: The BOTSv3 write-up - jonathan park</title>

        <meta charset="UTF-8" />
        <meta name="title" content="Jonathan Park" />
        <meta name="description" content="$ whoami /all" />
        <meta name="keywords" content="Jonathan Park" />
        <meta name="robots" content="index, follow" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="language" content="English" />
        <meta name="author" content="Jonathan Park" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <meta
            property="og:image"
            content="https://www.parkdj.com/uploads/botsv3-thumb.jpg"
        />
        <meta
            property="og:title"
            content="Live: the BOTSv3 writeup - jonathan park"
        />
        <meta
            property="og:description"
            content="Chugging through a Splunk CTF."
        />

        <meta property="twitter:card" content="summary_large_image" />

        <link
            href="https://fonts.cdnfonts.com/css/sf-pro-display"
            rel="stylesheet"
        />
        <link rel="stylesheet" href="../../stylesheet.css" />
        <link rel="stylesheet" href="../blog-stylesheet.css" />

        <!-- font awesome -->
        <script
            src="https://kit.fontawesome.com/5177f0fe75.js"
            crossorigin="anonymous"
        ></script>

        <link href="../../themes/prism.css" rel="stylesheet" />
        <style>
            h4 {
                margin-bottom: 5px;
            }
            #pttext {
                display: none;
            }
            button {
                border: none;
                background: rgba(24, 131, 12, 0.4);
                font-family: "SF Pro Display";
                cursor: pointer;
                padding: 5px 10px;
                margin: 0;
                margin-right: 5px;
                color: white;
                font-weight: bold;
            }
            s {
                color: #555;
                & li {
                    color: #555;
                }
            }
        </style>
        <!-- copyTableofContents(): copy table of contents into the sidebar -->
        <script>
            // Function to copy table of contents
            function copyTableOfContents() {
                // Find the source div with class 'table-of-contents'
                const sourceDiv = document.querySelector(".table-of-contents");

                // Find the target div with id 'table-of-contents-copy'
                const targetDiv = document.getElementById(
                    "table-of-contents-copy",
                );

                // Check if both elements exist
                if (!sourceDiv) {
                    console.error(
                        'Source div with class "table-of-contents" not found',
                    );
                    return;
                }

                if (!targetDiv) {
                    console.error(
                        'Target div with id "table-of-contents-copy" not found',
                    );
                    return;
                }

                // Copy the innerHTML from source to target
                targetDiv.innerHTML = sourceDiv.innerHTML;

                console.log("Table of contents copied successfully");
            }

            // Option 1: Run immediately when script loads (if DOM is ready)
            if (document.readyState === "loading") {
                document.addEventListener(
                    "DOMContentLoaded",
                    copyTableOfContents,
                );
            } else {
                copyTableOfContents();
            }
        </script>
    </head>
    <body>
        <div class="all-content-container">
            <div class="header">
                <a href="../../"><h1>jonathan park</h1></a>
            </div>
            <div class="blog-list-container">
                <div class="sidebar">
                    <img
                        src="https://media1.tenor.com/m/j8XyZWDIn-8AAAAC/penguin-walking.gif"
                        style="width: 30%"
                    />
                    <p>
                        Graduate cum laude of the University of Southern
                        California.
                    </p>
                    <p>
                        <i class="fa-solid fa-location-dot"></i>&nbsp;
                        California
                    </p>
                    <a href="https://www.linkedin.com/in/jon25/"
                        ><p>
                            <i class="fa-brands fa-linkedin"></i> &nbsp;<strong
                                >LinkedIn</strong
                            >
                        </p></a
                    >
                    <div id="table-of-contents-copy"></div>
                </div>
                <div class="blog-content">
                    <a href="../../blog.html" style="text-decoration: underline"
                        ><h6>&lt;&lt; Back</h6></a
                    >

                    <h2 id="top" style="margin-top: 10px">
                        The BOTSv3 write-up
                    </h2>
                    <h6>4 August 2025 - present</h6>
                    <svg height="30" width="12" class="blinking">
                        <circle cx="5" cy="25" r="5" fill="#d00" />
                        Sorry, your browser does not support inline SVG.
                    </svg>
                    <span
                        style="
                            font-family: &quot;SF Pro Display&quot;;
                            font-weight: bold;
                            color: #d00;
                        "
                        >live</span
                    >
                    <style>
                        .blinking {
                            -webkit-animation: 1s blink ease infinite;
                            -moz-animation: 1s blink ease infinite;
                            -ms-animation: 1s blink ease infinite;
                            -o-animation: 1s blink ease infinite;
                            animation: 1s blink ease infinite;
                            display: inline;
                        }

                        @keyframes "blink" {
                            from,
                            to {
                                opacity: 0;
                            }
                            50% {
                                opacity: 1;
                            }
                        }

                        @-moz-keyframes blink {
                            from,
                            to {
                                opacity: 0;
                            }
                            50% {
                                opacity: 1;
                            }
                        }

                        @-webkit-keyframes "blink" {
                            from,
                            to {
                                opacity: 0;
                            }
                            50% {
                                opacity: 1;
                            }
                        }

                        @-ms-keyframes "blink" {
                            from,
                            to {
                                opacity: 0;
                            }
                            50% {
                                opacity: 1;
                            }
                        }

                        @-o-keyframes "blink" {
                            from,
                            to {
                                opacity: 0;
                            }
                            50% {
                                opacity: 1;
                            }
                        }
                    </style>

                    <br /><br />

                    <button id="en-button">EN</button>
                    <button id="pt-button">PT</button>

                    <!-- english text -->
                    <div id="entext">
                        <div class="table-of-contents">
                            <p><strong>Contents</strong></p>
                            <p><a href="#intro">Introduction</a></p>
                            <p>
                                <a href="#question-200"
                                    >Question 200: List out the IAM users
                                    that...</a
                                >
                            </p>
                        </div>

                        <h4 id="intro">Introduction</h4>
                        <h6><a href="#top">Back to top</a></h6>

                        <p>
                            Having just obtained my Splunk Core Certified User
                            certification, it goes without saying that that
                            marks only the beginning of my Splunk journey. In
                            <a href="splunk.html">my previous blog post</a>
                            where I talked about getting the cert, I had debated
                            whether I wanted to branch out into other things to
                            get the experience or if I should dive deeper into
                            Splunk and learn even more about the tool.
                            Evidently, this new blog post answers that one.
                        </p>

                        <p>
                            The next logical step, then, would be to actually go
                            through the BOTSv3 dataset that I had downloaded
                            previously, and properly answer the questions that
                            came along with it. Well, it didn't "come along with
                            it," exactly; Splunk themselves never really made it
                            public and I had to dig through other people's
                            writeups to find them.
                        </p>
                        <p>
                            This blog post will be a little different: instead
                            of trying to publish this as a completed product,
                            I'll post my progress day to day, mostly as a proof
                            of my own consistent work and also as further
                            motivation to actually get through it.
                        </p>

                        <h4 id="question-200">
                            Question 200: List out the IAM users that accessed
                            an AWS service (successfully or unsuccessfully) in
                            Frothly’s AWS environment?
                        </h4>
                        <h6><a href="#top">Back to top</a></h6>
                        <br />

                        <iframe
                            width="100%"
                            height="315"
                            src="https://www.youtube.com/embed/6WZxmXhdJOo?si=jWrk8PxvnU5hE_ec"
                            title="YouTube video player"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            referrerpolicy="strict-origin-when-cross-origin"
                            allowfullscreen
                        ></iframe>

                        <br /><br />

                        <div class="code-general">
                            <pre><code>
index=botsv3 sourcetype="aws:cloudtrail" host="splunk.froth.ly"
| search recipientAccountId=622676721278
| search userIdentity.type=IAMUser
| stats count by userIdentity.userName</code>
                            </pre>
                        </div>

                        <p>Output:</p>
                        <ul>
                            <li>
                                <code>bstoll</code>
                            </li>
                            <li>
                                <code>btun</code>
                            </li>
                            <li>
                                <code>splunk_access</code>
                            </li>
                            <li>
                                <code>web_admin</code>
                            </li>
                        </ul>
                    </div>

                    <!-- portuguese text -->
                    <div id="pttext">
                        <div class="table-of-contents">
                            <p><strong>Sumário</strong></p>
                            <p><a href="#intro-pt">Introdução</a></p>
                            <p><a href="#question-200-pt"
                                >Question 200: List out the IAM users
                                that...</a
                            ></p>
                        </div>

                        <!-- #intro-pt -->
                        <h4 id="intro-pt">Introdução</h4>
                        <h6><a href="#top">Voltar acima</a></h6>

                        <p>
                            Agora que obtei o meu certificado Splunk Core
                            Certified User, escusado será dizer que esse só
                            marca o começo da minha viagem no Splunk. No
                            <a href="splunk.html">meu blog post anterior</a>, eu
                            tinha debatido se eu quisesse aprender outras coisas
                            ou mergulhar mais no Splunk e aprender ainda mais
                            sobre o instrumento. Claro que este blog post
                            responde a essa questão.
                        </p>
                        <p>
                            O próximo passo lógico, então, seria passar mesmo
                            pelo conjunto de dados BOTSv3 que eu baixava antes,
                            e propriamente responder as perguntas que vieram
                            juntos com ele. Bem, as perguntas nem exatamente
                            "vieram juntos": o Splunk nunca as fez públicas, e
                            eu tive que buscar por outros blogposts da outra
                            gente para encontrá-las.
                        </p>
                        <p>
                            Este blog post vai ser um pouco diferente: em vez de
                            tentar publicá-lo como um produto completado,
                            postarei o meu progresso dia por dia, maioriamente
                            como uma prova do meu próprio trabalho consistente e
                            também para me dar mais motivação de tentar passar
                            mesmo por ele.
                        </p>

                        <h4 id="question-200-pt">
                            Question 200: List out the IAM users that accessed
                            an AWS service (successfully or unsuccessfully) in
                            Frothly’s AWS environment?
                        </h4>
                        <h6><a href="#top">Voltar acima</a></h6>
                        <br />

                        <iframe
                            width="100%"
                            height="315"
                            src="https://www.youtube.com/embed/6WZxmXhdJOo?si=jWrk8PxvnU5hE_ec"
                            title="YouTube video player"
                            frameborder="0"
                            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                            referrerpolicy="strict-origin-when-cross-origin"
                            allowfullscreen
                        ></iframe>

                        <br /><br />

                        <div class="code-general">
                            <pre><code>
index=botsv3 sourcetype="aws:cloudtrail" host="splunk.froth.ly"
| search recipientAccountId=622676721278
| search userIdentity.type=IAMUser
| stats count by userIdentity.userName</code>
                            </pre>
                        </div>

                        <p>Output:</p>
                        <ul>
                            <li>
                                <code>bstoll</code>
                            </li>
                            <li>
                                <code>btun</code>
                            </li>
                            <li>
                                <code>splunk_access</code>
                            </li>
                            <li>
                                <code>web_admin</code>
                            </li>
                        </ul>
                    </div>
                    </div>

                    <!-- script to switch between eng and pt text -->
                    <script>
                        const enButton = document.getElementById("en-button");
                        const ptButton = document.getElementById("pt-button");
                        const enDiv = document.getElementById("entext");
                        const ptDiv = document.getElementById("pttext");
                        const sidebarTOC = document.getElementById(
                            "table-of-contents-copy",
                        );
                        const enTOC = document.querySelector(
                            "#entext .table-of-contents",
                        );
                        const ptTOC = document.querySelector(
                            "#pttext .table-of-contents",
                        );

                        enButton.addEventListener("click", () => {
                            enDiv.style.display = "block";
                            ptDiv.style.display = "none";
                            sidebarTOC.innerHTML = enTOC.innerHTML;
                        });

                        ptButton.addEventListener("click", () => {
                            ptDiv.style.display = "block";
                            enDiv.style.display = "none";
                            sidebarTOC.innerHTML = ptTOC.innerHTML;
                        });
                    </script>
                </div>
            </div>
        </div>

        <script src="../../themes/prism.js"></script>
    </body>
</html>
